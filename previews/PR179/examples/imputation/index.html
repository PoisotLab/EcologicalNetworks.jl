<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>- · EcologicalNetworks</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="EcologicalNetworks logo"/></a><div class="docs-package-name"><span class="docs-autofit">EcologicalNetworks</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Index</a></li><li><span class="tocitem">Interface</span><ul><li><a class="tocitem" href="../../interface/types/">Types</a></li><li><a class="tocitem" href="../../interface/conversions/">Conversions</a></li><li><a class="tocitem" href="../../interface/highlevel/">Core functions</a></li><li><a class="tocitem" href="../../interface/abstractarray/">AbstractArray</a></li><li><a class="tocitem" href="../../interface/iterate/">Iterate</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../modularity/">Modularity</a></li><li><a class="tocitem" href="../integration_mangal/">Integration with Mangal</a></li><li><a class="tocitem" href="../beta-diversity/">Network beta-diversity</a></li><li><a class="tocitem" href="../extinctions/">Extinctions</a></li></ul></li><li><span class="tocitem">Basic measures</span><ul><li><a class="tocitem" href="../../properties/links/">Links</a></li><li><a class="tocitem" href="../../properties/modularity/">Modularity</a></li><li><a class="tocitem" href="../../properties/nestedness/">Nestedness</a></li><li><a class="tocitem" href="../../properties/motifs/">Motifs</a></li><li><a class="tocitem" href="../../properties/paths/">Centrality and paths</a></li><li><a class="tocitem" href="../../properties/overlap/">Overlap and similarity</a></li></ul></li><li><span class="tocitem">Advanced information</span><ul><li><a class="tocitem" href="../../properties/betadiversity/">Beta-diversity</a></li><li><a class="tocitem" href="../../properties/resilience/">Resilience</a></li><li><a class="tocitem" href="../../properties/information/">Information theory</a></li></ul></li><li><span class="tocitem">Generating networks</span><ul><li><a class="tocitem" href="../../random/null/">Null models</a></li><li><a class="tocitem" href="../../random/structure/">Structural models</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>-</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>-</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/EcoJulia/EcologicalNetworks.jl/blob/master/docs/src/examples/imputation.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h2 id="Interaction-imputation-1"><a class="docs-heading-anchor" href="#Interaction-imputation-1">Interaction imputation</a><a class="docs-heading-anchor-permalink" href="#Interaction-imputation-1" title="Permalink"></a></h2><p>In the final example, we will apply the linear filtering method of @StocPois17 to suggest which negative interactions may have been missed in a network. Starting from a binary network, this approach generates a quantitative network, in which the weight of each interaction is the likelihood that it exists – for interactions absent from the original network, this suggests that they may have been missed during sampling. This makes this approach interesting to guide empirical efforts during the notoriously difficult task of sampling ecological networks [@Jord16; @Jord16a].</p><p>In the approach of @StocPois17, the filtered interaction matrix (<em>i.e.</em> the network of weights) is given by</p><p>\begin{equation} F<em>{ij} = \alpha</em>1Y<em>{ij} + \alpha</em>2\sum<em>k\frac{Y</em>{kj}}{n} + \alpha<em>3\sum</em>l\frac{Y<em>{il}}{m} + \alpha</em>4\frac{\sum Y}{n\times m} \,, \end{equation}</p><p>where <span>$\alpha$</span> is a vector of weights summing to 1, and <span>$(n,m)$</span> is the size of the network. Note that the sums along rows and columns are actually the in and out degree of species.  This is implemented in <code>EcologicalNetworks</code> as the <code>linearfilter</code> function. As in @StocPois17, we set all values in <span>$\alpha$</span> to <span>$1/4$</span>. We can now use this function to get the top interaction that, although absent from the sampled network, is a strong candidate to exist based on the linear filtering output:</p><pre><code class="language-julia">N = networks[50]
F = linearfilter(N)</code></pre><p>We would like to separate the weights in 3: observed interactions, interactions that are not observed in this network but are observed in the metaweb, and interactions that are never observed. <code>EcologicalNetworks</code> has the <code>has_interaction</code> function to test this, but because <code>BinaryNetwork</code> are using Boolean values, we can look at the network directly:</p><pre><code class="language-julia">scores_present = sort(
  filter(int -&gt; N[int.from, int.to], interactions(F)),
  by = int -&gt; int.probability,
  rev = true);

scores_metaweb = sort(
  filter(int -&gt; (!N[int.from,int.to])&amp;(metaweb[int.from, int.to]), interactions(F)),
  by = int -&gt; int.probability,
  rev = true);

scores_absent = sort(
  filter(int -&gt; !metaweb[int.from,int.to], interactions(F)),
  by = int -&gt; int.probability,
  rev = true);</code></pre><p>The results of this analysis are presented in @fig:imputation: the weights <span>$F_{ij}$</span> of interactions that are present locally (<span>$Y_{ij}=\text{true}$</span>) are <em>always</em> larger that the weight of interactions that are absent; furthermore, the weight of interactions that are absent locally are equal to the weight of interactions that are also absent globally, strongly suggesting that this network has been correctly sampled.</p><pre><code class="language-julia">nx, ny = range(0.0, stop=1.0, length=length(scores_present)), [x.probability for x in scores_present]
pl = plot(nx, ny, grid=false, frame=:origin, lw=2, lab=&quot;Present locally&quot;, c=:black)
nx, ny = range(0.0, stop=1.0, length=length(scores_metaweb)), [x.probability for x in scores_metaweb]
plot!(pl, nx, ny, c=:black, lab=&quot;Present globally&quot;)
nx, ny = range(0.0, stop=1.0, length=length(scores_absent)), [x.probability for x in scores_absent]
plot!(pl, nx, ny, c=:darkgrey, ls=:dash, lab=&quot;Absent&quot;)
xaxis!(pl, &quot;Relative rank&quot;, (0,1))
yaxis!(pl, &quot;Interaction weight&quot;, (0,1))
savefig(&quot;figures/imputation.pdf&quot;)</code></pre><p><img src="figures/imputation.pdf" alt="Relative weights (higher weights indicates a larger chance that the interaction has been missed when sampling) in one of the host-parasite networks according to the linear filter model of @StocPois17."/>{#fig:imputation}</p></article></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 1 December 2020 14:45">Tuesday 1 December 2020</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
